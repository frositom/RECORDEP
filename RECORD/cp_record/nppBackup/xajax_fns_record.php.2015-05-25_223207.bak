<?php// date_default_timezone_set('America/Guatemala');header('Content-Type: text/html; charset=ISO-8859-1');
// include_once('html_fns_menu.php');include_once('html_fns_record.php');
include_once("../html_fns.php");
//inclu?s la clase ajax
// require ('../xajax/xajax_core/xajax.inc.php');
require ('../xajax/xajax_core/xajax.inc.php');
// require ('xajax_core/xajax.inc.php');
// header("Content-Type: text/html;charset=utf-8");

//instanciamos el objeto de la clase xajax
$xajax = new xajax();
$xajax->setCharEncoding('ISO-8859-1');  // debe llevar esta linea de codigo para 
$xajax->configure('decodeUTF8Input',true);  // para corregir 
	// xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx	//Xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx	//xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx FUNCIONES PARA BUSCAR INFO PERSONAL   xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx	// xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx	//Xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx				function Buscar_Informacion($form){			$respuesta = new xajaxResponse();									//xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx ASIGNO LOS VALORES DE LOS CAMPOS DEL FORMULARIO frm_record.php   xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx			$cat = trim($form['txt_catalogo']);			$gra = $form['cmb_cad_grados'];			$nom1=trim(strtoupper($form['txt_nom1']));			$nom2=trim( strtoupper($form['txt_nom2']));			$ape1 =trim(strtoupper($form['txt_ape1']));			$ape2= trim(strtoupper($form['txt_ape2']));			$prom = trim($form['txt_promocion']);			$sem = $form['cmb_semestres'];			$cia = $form['cmb_companias'];									$ClsRec = new ClsRecord();			$result = $ClsRec->get_cadetes($cat,$gra,$nom1,$nom2,$ape1,$ape2,$prom,$sem,$cia);			// $respuesta->alert($result);			if(is_array($result)){				// $respuesta->alert($cont);				$contenido =tabla_cadetes($cat,$gra,$nom1,$nom2,$ape1,$ape2,$prom,$sem,$cia);  // asigno la información de la tabla a la variable $contenido				$respuesta->assign("resultado_cadetes","innerHTML",$contenido);		// la variable respuesta la asigno al Div resultado_cadetes para que me despliegue la informacion			}else{				$respuesta->alert("No se reportan datos en la busqueda");	// si no trae datos levanto una alerta.			}			return $respuesta;		}			//Xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx	//xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx FUNCIONES PARA BUSCAR INFO PERSONAL   xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx	// xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
	function Trae_Info_Sel($cat){		// $catalogo_sel='';			$respuesta = new xajaxResponse();						$ClsRec = new ClsRecord();			$result = $ClsRec->get_cadete_sel($cat);			// $respuesta->alert($result);			if(is_array($result)){				foreach($result as $row){					$catalogo_sel= TRIM($row['cad_catalogo']);					$grado_cod_sel=$row['cgr_codigo'];					$grado_desc_sel= TRIM($row['cgr_desc_larga']);					$nombres_sel=TRIM(utf8_encode($row['cad_ape1']))." ".TRIM(utf8_encode($row['cad_ape2'])).", ".TRIM(utf8_encode($row['cad_nom1']))." ".TRIM(utf8_encode($row['cad_nom2']));					$semestre_sel=TRIM($row['cad_semestre']);					$cia_sel=TRIM($row['cad_cia']);										session_start();					$_SESSION['rec_nombres']=$nombres_sel; 					$_SESSION["rec_catalogo"]=$catalogo_sel;					$_SESSION["rec_gra_codigo"]=$grado_cod_sel;					$_SESSION["rec_gra_desc"]=$grado_desc_sel;					// $_SESSION["rec_nombres"]=$nombres_sel;					$_SESSION["rec_semestre"]=$semestre_sel;					$_SESSION["rec_cia"]=$cia_sel;										// $respuesta->alert($_SESSION['rec_nombres']);	// si no trae datos levanto una alerta.					$respuesta->script("document.getElementById('btn_envia').click();");															// echo "<form id='form_record' name='form_record' action='../cp_record_infoper/frm_record_infoper.php' method='post'>";					// echo "<script>document.form_record.submit();</script>";					// echo "</form>";				}			}else{				$respuesta->alert("No se reportan datos en la busqueda");	// si no trae datos levanto una alerta.			}			return $respuesta;		}			//Xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx	//xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx FUNCIONES PARA BUSCAR INFO PERSONAL   xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx	// xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx	function Limpiar(){			$respuesta = new xajaxResponse();						//xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx LIMPIO  LOS VALORES DE LOS CAMPOS DEL FORMULARIO frm_record.php   xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx						$respuesta->assign("txt_catalogo","value","");			$respuesta->assign("cmb_cad_grados","value","");			$respuesta->assign("txt_nom1","value","");			$respuesta->assign("txt_nom2","value","");			$respuesta->assign("txt_ape1","value","");			$respuesta->assign("txt_ape2","value","");			$respuesta->assign("txt_promocion","value","");			$respuesta->assign("cmb_semestres","value","0");			$respuesta->assign("cmb_companias","value","0");												$contenido = ''; // asigno la información de la tabla a la variable $contenido			$respuesta->assign("resultado_cadetes","innerHTML",$contenido);		// la variable respuesta la asigno al Div resultado_cadetes para que me despliegue la informacion			return $respuesta;		}			//Xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx	//xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx DECLARO LAS FUNCIONES XAJAX PARA QUE LAS PUEDA INVOCAR DESDE EL FORMULARIO   xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx	// xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx		
	$xajax->register(XAJAX_FUNCTION, "Buscar_Informacion");	$xajax->register(XAJAX_FUNCTION, "Trae_Info_Sel");	$xajax->register(XAJAX_FUNCTION, "Limpiar");

//El objeto xajax tiene que procesar cualquier petición
	$xajax->processRequest();
	
?>